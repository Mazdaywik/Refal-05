* Test advanced Unicode features

$ENTRY Go {
  = <TestCharTypes>
    <TestCaseConversion>
    <TestPatternMatching>
    <TestMixedStrings>;
}

* Test character types
TestCharTypes {
  = <Prout 'Testing character types:'>
    <Prout '  Type of A: ' <ShowType <Type 'A'>>>
    <Prout '  Type of 5: ' <ShowType <Type '5'>>>
    <Prout '  Type of Ð–: ' <ShowType <Type 'Ð–'>>>
    <Prout '  Type of ä¸­: ' <ShowType <Type 'ä¸­'>>>
    <Prout '  Type of ðŸŽ‰: ' <ShowType <Type 'ðŸŽ‰'>>>
    <Prout '  Type of space: ' <ShowType <Type ' '>>>;
}

ShowType {
  'L' s.Sub e.Rest = 'Letter (' s.Sub ')';
  'D' s.Digit = 'Digit';
  'W' s.Sub e.Rest = 'Word (' s.Sub ')';
  'P' s.Sub e.Rest = 'Punctuation (' s.Sub ')';
  'S' s.Sub e.Rest = 'Space (' s.Sub ')';
  e.Other = e.Other;
}

* Test case conversion
TestCaseConversion {
  = <Prout 'Testing case conversion:'>
    <Prout '  Upper(hello Ð¼Ð¸Ñ€): ' <Upper 'hello Ð¼Ð¸Ñ€'>>
    <Prout '  Lower(HELLO ÐœÐ˜Ð ): ' <Lower 'HELLO ÐœÐ˜Ð '>>
    <Prout '  Mixed case: ' <Upper 'a'> <Lower 'B'> <Upper 'Ð¶'> <Lower 'Ð©'>>;
}

* Test pattern matching with Unicode
TestPatternMatching {
  = <Prout 'Testing pattern matching:'>
    <TestMatch ('ÐÐ‘Ð’') ('ÐÐ‘Ð’')>
    <TestMatch ('ABC') ('ÐÐ‘Ð’')>
    <TestMatch ('ä¸­æ–‡') ('ä¸­æ–‡')>
    <TestMatch ('ðŸŒðŸŒŽðŸŒ') ('ðŸŒðŸŒŽðŸŒ')>;
}

TestMatch {
  (e.X) (e.X) = <Prout '  Match ' e.X ' = ' e.X ': YES'>;
  (e.X) (e.Y) = <Prout '  Match ' e.X ' != ' e.Y ': NO'>;
}

* Test mixed ASCII/Unicode strings
TestMixedStrings {
  = <Prout 'Testing mixed strings:'>
    <ParseMixed 'Hello, Ð¼Ð¸Ñ€! ä½ å¥½ ðŸŒ'>
    <ParseMixed 'Test123ãƒ†ã‚¹ãƒˆ'>;
}

ParseMixed {
  s.Char e.Rest = <Prout '  Char: ' s.Char ' (code ' <Ord s.Char> ')'>
                  <ParseMixed e.Rest>;
  /* empty */ = /* done */;
}